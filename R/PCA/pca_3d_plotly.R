library(plotly)
trace1 <- list(
  mode = "markers", 
  name = "Embryonic Stem Cells", 
  type = "scatter3d", 
  x = c(-1.4608512919594783, -4.894199603914668, -2.5866415852759337, -0.1751783215819445, -1.8413633012455755, -5.385577830310617, -2.5212713416685486, -3.6983132813768846, 0.07583648838409549, 1.8769462530763739, -4.46649177294378, 2.9744302812951573, 2.713300118470268, -1.362928758333634, -1.059734719490578, -2.211662868575708, -2.6239774882547553, 4.755584769314518, 0.7676994014929466, -1.5049568766956871, -4.939224327096979, -4.696340357678683, -1.5959639602315736, 4.801679493820368, 0.6191592554275726, -5.158578061060696, 1.6913805927632193, 4.758137881232421, -4.996748507553572, 0.5699599116862634, -4.697926217627725, -2.394074391946846, -4.2419605955953035, -1.2474147734113437, -2.1367640876758798, 0.5443639190157936, -2.980070835088271, 2.779350000996176, -2.763765566254878, 0.13680333317606513, -1.7945971800223446, -4.135757471813097, -3.19760388828093, -1.4701186989716126, -0.10117210648927846, -2.996947673878389, -1.2734334973711445, 0.4533567030552494, -3.518452503288567, -4.301382047963384, 0.1967201210411182, -0.28400347155198313, 0.7851297686435106, -3.1775056834499273, -1.947264687879121, 4.719342548665219, -4.393367535472197, -2.6780763126222564, -3.586674223195943, -2.5528481738914937, -2.6645987628574583, 0.9268214522197663, 1.4190326985915238, -2.95092909147704, 4.573901090164091, -4.785311401171167, -2.42663259141002, -2.7924001300357184, -2.870383013311704, -2.2545003543456703, -4.354330669013659, 1.0604095357183263, -0.4695141442135712, 2.4470703268146523, 3.793840784947015, -2.41938860817355, -3.890671299822524, -1.8680875430764023, 9.306541624777433, 0.7096736266843771, -0.1126726266409029, 1.0008856941133246, -1.567463952840271, 0.013408875790544263, -5.077644524121522, 3.0515430855821974, 2.903440944819725, -4.741875821575166, -1.4217437488695797, -0.6505670657615735, -5.142704842562431, -0.09505966469835166, 0.7030678594396246, -0.0993957890101836, -4.247720992475909, -3.8413591250743604, -0.8387567518910088, -4.633440807997506, -3.036540666069797, -4.388772963015735, -4.729984754043707, 2.477379125298927, -0.8308738372358458, -2.453736928833298, -4.503444840143263, -4.689285369641509, 1.1540449706792542, -2.004767101325997, -4.143814836985326, 4.331310801153501, -4.933086075039621, 1.178450513936204, 1.9522613337379628, -2.1434732735005175, -3.0770486424704178, -1.121697568173789), 
  y = c(0.3286735330157318, 0.26093012512392816, -0.051552578395957, -11.957367255729867, 0.6636962848568015, 0.38307589504281103, -3.3959574995296427, 0.27875113806799146, 0.13292847723113876, 0.3416176317238774, 0.12384674870364787, 0.21375927643830553, -2.4734259616418215, -0.5678278741998167, -10.664493460373496, 0.4881810240772008, 0.14386143584527775, 1.4541714715893284, -0.007255640173230676, -2.6479820337602864, 0.2566769047224435, 0.27988679820672785, -0.05026870033901527, 2.5236467068836173, 0.1715668263993677, 0.24982680955317735, 0.6152285336905842, 1.467295187458903, 0.3391500675626368, 6.831515190025428, 0.22428502774393572, 0.09672567271925399, 0.29167062089582846, 0.1768772675125085, 0.3773127211665698, 0.19239488740457922, 0.08423041475476728, 0.3274549859014483, 0.3969384408612106, 0.15011023625840142, 0.16461345142012898, 0.2205023631198565, 0.08188219215442272, 3.365983291597025, 0.23694906364591015, 0.1694413399027428, 0.11407546943442975, -0.141330370167768, 0.3889057430627589, 0.028297342866004924, 0.3576958581715108, 0.14886330872680287, 7.429264251140453, 0.4193896250418856, -0.49717374591949676, 0.09801938751700555, 0.18727172564440037, -0.11215319212824809, -0.03342403909434575, 0.2971300634132337, 0.24895442959753186, 0.5178402122854661, 7.503068245504703, 0.20296578019483844, 0.5751625443322393, 0.274368361929066, -2.464862982056475, -0.06506406459422356, 0.2516245457588403, 0.23684588598123793, 0.2360177760491857, -0.29343833169816225, 0.3248144777771817, 0.5809846235975481, 0.7144617657629465, 0.44808915912238173, -0.02075949017968451, -0.25396083620954246, 4.728097445592102, -1.011667261390935, -0.1556541223324656, 4.169328581489507, 0.07489158462464011, 0.4490008294134716, 0.30321964956885294, 0.3308805819114233, 0.5134456996160213, 0.24704601424235548, 0.021495858544404816, -0.42479961241456593, 0.2606231562852116, 0.41886429535022207, 0.22139608416905202, -9.764138411430823, 0.2505620989265942, 0.23234629059035683, 0.32998728145273754, 0.2248969079913225, 0.29880532109425784, 0.29493653253762486, 0.3048218611614626, 11.502073566432342, -0.045938876038288806, 0.04308882402965172, 0.3243730986232334, -0.0003977009568998974, -0.11630990568586827, 0.28493592212233876, -0.5031654792011817, 2.117704174510093, 0.2643384335867571, 0.3246124297191897, 7.270518769370234, 0.27547931878002646, 0.1513669514258631, 0.33250513419802397), 
  z = c(-1.272106568369907, 0.5832160409995284, -0.4121846076403853, 8.6459970340388, -0.2035303128455533, 0.47653598227616223, 2.5258996331642356, 0.01324922792381265, -1.6806955259794092, -3.2691243852007013, 0.19645015681888459, -3.364615330113231, -1.7919144446180653, -0.6763224926365036, 7.81305501267697, -0.6741009395653191, -0.5303956013464235, -1.8967955627614503, -2.1116275365514987, 1.487120111991849, 0.3146134689009847, -0.17998706889896063, -0.692141192599548, -0.08439646526604765, -1.9519094222496218, 0.3334892253795678, -3.9279021083541195, -2.0303035752090763, 0.38870852757661056, 7.272295999065634, 0.3618602825910033, -0.5097380427464383, 0.20319945954655272, -0.8612781508472955, -0.6885996275396752, -1.8856464827508146, 0.04910219095837251, -2.9119429895193423, -0.9987416647357744, -1.298660367143873, -0.7010699622671928, -0.044761182264065495, -0.228457443592648, 3.5945284544094505, -1.6039305065217937, -0.3380431799008619, -1.0814913003511128, -1.692362197617759, -0.11025646716349304, 0.2737864779221756, -1.8934334407668638, -1.6791070959123064, 8.437683908484669, -0.07016683582624235, -0.6272925051112263, -4.015090816899482, 0.3963292930463736, -0.2579041624722375, -0.12576790733785242, -0.5444895160748197, -0.8774416382495384, -2.6702943229286658, 7.851922496849533, -0.17543020060610898, -5.1377288697058665, 0.3148797453679216, 1.3352996231039223, -0.31295184509541674, -0.398946604226788, -0.6386625539722977, 0.23137567146542976, -2.140637822072481, -0.8283128751507681, -4.219741019955845, -3.6173220140349582, -0.7450811962645428, 0.15946526662441143, -0.40102435154990296, 3.087059380231323, -0.7601337271036807, -1.6997177517899908, 3.7046670533881634, -0.3090835549668791, -2.569526246480274, 0.45977134373150474, -3.149672032464059, -4.387750292852707, 0.3443826414016268, -0.871979584587143, -1.1841611762781066, 0.45095798137501053, -1.487826052990319, -2.108177751863881, 6.7670450229996915, 0.054984816028547406, 0.02746886778641939, -1.205000525143829, 0.37381881152796237, 0.22514760855331226, 0.10163173573479806, 0.35165348053382056, 13.567674964811241, -1.24201026410142, -0.9316444678112784, 0.3247188779738684, 0.1636695012734689, -1.9338673987579154, -0.7059471836437321, 0.41600645790007285, -0.9735541852657259, 0.408232526788642, -2.1041606805476434, 7.582546985155822, -0.6227747355211058, 0.06054735624886681, -1.7721896407358666)
)
trace2 <- list(
  mode = "markers", 
  name = "Brain Cells", 
  type = "scatter3d", 
  x = c(-0.029748542139977352, -4.4511282469445135, -0.45246940251110346, 2.4437354604505255, 0.05413871975870839, -1.4152811142387312, -3.4715027882829186, -2.2841470473189682, -4.395003646970069, -1.9646569611338278, -4.861082936613051, -3.7356440971532745, -4.605828545371409, -0.3321109083235049, -4.218201355813416, -5.189699530071125, -2.626491217213573, -1.852484701994405, 0.4434277972055146, -1.3861756280948256, -2.6637347428217626, -4.792035943913988, -4.161509917493075, -0.41099516273037673, -4.134040836126846, 0.2575349461215688, 1.438345867406609, 1.222911150232311, -1.8443067648026723, -0.7919272262394883, 1.7810986129194313, -5.507569097087481, 1.9242414781692165, -0.8640291700344279, -1.949723530580598, 2.3443835890648494, -2.3206903441259397, -4.172668998275415, 0.8068424916066633, 1.3891430422506823, -3.3876349102782903, 4.011123582092206, -0.242315733400087, 0.6622428038630812, -1.8976258924815796, 0.8497675576375942, 0.025810742730039544, -4.178714974230901, 4.777225366617858, 2.0495608550496227, 1.6389867426446598, -2.958892142686726, 0.5780636143948266, -4.6722963044438774, 4.15653939208768, -1.1292072732863347, 2.552499243280261, -1.1594706757944035, -3.622092540144019, 3.4939744423528176, -2.0261584485715303, -4.4471692263086, -0.2208338061572793, 4.2743115120903, 0.4726682178267938, -1.2296311880307242, -1.444675180092863, -1.092670205682161, 1.077882882625277, 2.68011751415684, -1.499880906283833, -3.5328705799704165, -1.1769683703155696, -1.947631178127398, 0.30849915336638983, -3.0996270309573184, -4.754129261773189, 1.297391265546743, -0.4716361537422636, 3.6975195903428193, 6.40243722289751, 9.558009312605416, -0.5229013969524823, 4.241238034744808, 8.440048502280689, 2.0429177324976773, -3.139831910961417, -1.5919938964752414, 1.386852983925969, -2.0416071213278997, -1.2627560055143383, -0.3683331319489336, 1.3853812319079761, -3.7052406085117413, -1.180544525559012, -4.601380443713143, -3.0614351311792323, -1.025661958525335, -1.2218623127556458, -3.0868101392795975, -0.1426698571557199, 3.713602521964975, -4.540130707228532, 6.578868704231685, -2.434396520874504, -0.7905786063912625, -2.4268582097879468, -0.2423186240826709, 1.9339385657761126, 0.3714843332736987, 1.6894097518311992, -4.890919370971802, 1.743528427517437, -3.1335022117265727, 2.9189954488450014, 2.2343216571681133), 
  y = c(0.17036933508500907, 0.30214297608273843, 0.05986097456232882, 0.3494540380241136, -13.018929382635532, -0.5823847449339217, 0.4285957165670034, -0.1897600448680249, 0.21665226419254618, 0.23433896346691935, 0.30778472773368776, 0.2220133742146294, 0.23887342298493205, -0.0603756291291547, 0.16559865744286845, 0.2579592680309991, 1.6240547124855786, -0.518664961351345, 0.38928546862565916, 0.075216255665668, 0.07662973008271518, 0.5292893856637628, 0.31213922535041566, -0.0010967360814613148, 0.3652420208048568, -0.43250658141475534, 0.3122396822261801, 0.438530930263087, 0.04380022735871446, -0.11444127412421345, 0.2906301667995885, 0.42744340685872545, 4.541566380171048, -4.976743586171275, 0.39070320459588515, 0.3523163765736838, -0.0023826204341615117, 0.2164386667303801, 0.15250143697335755, 0.49031541020436775, 0.05901051327666621, 0.0720439304968682, 0.5853232894472671, -0.21579367233652555, 0.3072500133962877, -13.132127797127447, 0.2529481610063515, 0.11870576916837218, 5.845904368970094, -0.9863282714603889, 0.7322802402625833, 0.14675984897637281, 0.20198597940247975, 0.2719746761094673, 0.30030442011774433, 0.12272270050077284, 0.3732928119996609, 0.3375610608370469, 0.8871523288408176, -12.459873136215432, 0.9768905614877164, 0.2816777110859019, 0.4777943989158218, -6.16561352561309, 3.717254234893679, 0.14130320670259555, 0.5698507190712524, 0.09351365343712124, 0.5601800574889023, 0.6004248260907749, 0.08755220811654013, 0.3689211746670485, 0.14627613170069356, -0.49087465155467286, -3.3004551133802607, 0.4578830605826142, -0.5455442659801575, 0.6775428326221281, 0.12451133239897413, 0.368022382081464, 0.04071144712905135, -2.571859149981292, -0.008883661609129768, 8.868493181034726, -0.18562277473280503, 3.011234331316732, 0.43598131550174996, -0.16567603324022367, 0.37281817083215163, 0.7603015077806186, 0.46300269014363865, 0.15389994196100873, 1.130468018074237, 0.1544243089478108, -0.6243212581282065, 0.29814589691281673, 0.013386098315339127, 0.13958369627264458, 0.46939095520923085, 0.07466764632286767, -0.04619680283846069, 0.5286829012712164, 0.285033587405366, -0.40167997005857436, 0.05226990570676179, 0.39743849074618953, 0.8409360438588029, -0.19055458058053548, 0.14726836179782526, 0.15266128448850658, -0.5845007863062723, -0.04506138683630665, 6.840897027725621, 0.28774156738759266, 0.3873292838684782, 1.812782289250401), 
  z = c(-1.8170865032533003, 0.15291771705100568, -1.2790133296573278, -3.1393912627689526, 9.413481676238945, -0.6565673295840837, 0.08361798365476054, -0.2609131994417416, 0.30494157391966825, -0.8292916849671566, 0.3641990322528479, 0.2613482403765698, 0.3321059287077991, -1.8953402884832684, 0.36532127505371237, 0.37712429728456986, 2.000646307559277, -0.6397762717578309, -1.6603692862896988, -0.9258552837366733, -0.40322671074692906, 0.8718171639362694, -0.08156849855946535, -1.7585376110827458, 0.387882993721818, -1.549538469046585, -2.317890162134421, -3.2436766254666023, -0.47778261495492835, -1.3418998437899798, -2.6777054250404446, 0.5476412758960254, 3.947236455253977, 2.2733777903552097, -0.6824562176216892, -2.731646541347776, -0.5714950777638264, -0.008268957195699098, -2.669453307858886, -2.4192162809599, -0.23933106763788548, -3.708770836118078, -3.0170883435933513, -1.9531736053227116, -0.5429463720293028, 9.040819714449139, -1.9985883516670826, -0.108789877428194, 14.433820425373883, -2.1629694678928493, -2.6242277720643377, -0.3853027197861487, -2.190166205516583, 0.07423373036299517, -4.042182214955434, -0.4449844191886344, -3.5971809382115536, -0.96723235138632, 0.8981372362782355, 7.255680738153073, -0.03703636422226814, 0.06232112931468699, -1.4043064162817613, 1.4402192833984202, 3.142362057466089, -0.8709280879991659, -0.3003025920271988, -1.1969269692964992, -2.4142606035888443, -4.312947701316557, -1.382284955754332, -0.6383631982927916, -0.5280809483484428, -0.5085052881478124, 1.9767250625533623, -0.3245700323788629, 0.9396765259832472, -2.2859173199555505, -1.2424084625511762, -3.915438078966571, 1.0966476830839436, 5.682425481905985, -1.2156130520132487, 8.727069201965662, -3.1015501852183918, 1.7628880463005023, -0.17041055296107613, -1.0881584227649854, -2.5098568805906947, -1.355322854767362, -0.9272032997757916, -1.6517328230077535, 4.316030798423376, -0.1594599709694241, -0.5140106393401825, 0.3300118855821694, -0.42500079745351377, -0.9600925663200325, -1.2671516218970427, -0.6990959133599148, -1.39948115466646, -3.7714246338017055, 0.29824556964490007, -3.6914613179929163, -0.567298294655067, -1.3878670089682033, 0.48874069274655707, -1.6990362457751484, -2.395481126573136, -2.1746327077944985, -2.0328380077697226, 0.6107990922724811, 7.3348147138339685, -0.5756698625943668, -3.2731816914003242, -0.4864211415989966)
)
trace3 <- list(
  mode = "markers", 
  name = "Embryonic Fibroblast Cells", 
  type = "scatter3d", 
  x = c(0.030726734301764223, 1.9599978618805995, -3.0647939709583367, -0.9057781354462867, -2.330500714510042, 1.7202318469233129, -1.9532266972518975, 1.777341946649161, -1.446519895400915, 1.8262834744358514, -1.0499996626487702, -2.4132982499694693, 0.8509645683131007, 1.456566795128961, -2.9458057520248206, 0.5797771910211997, -0.5299898502010025, -4.318054965018049, -2.919570093090529, -1.9052426035696386, -1.6917897988771549, -4.740695989368158, -5.013595770993837, -0.9006944089079522, -4.8843372350908, -1.7009934399932678, 0.8347177833205556, -4.220326667108569, -4.264139898699702, -1.0354961179721933, 4.827473718142508, -3.998653361882235, 2.8195910909404014, -2.622220577559965, 10.816433439828854, -2.624010190070166, 1.8987991704851357, -1.079443803949535, 0.48789784843460815, 3.5294938531526694, -1.5092154825260502, -0.7356706392774107, -1.756576134247786, -2.992559656209817, -0.3381030970785384, 2.5032114293942835, 2.3698626393072884, -1.45599221235449, 1.9143577917435048, -2.992659159758065, -3.1262655647333184, -1.6696725416801668, 1.5433325302880723, 2.4479757996952327, -1.069699140629158, 1.2181374678857038, 1.6705032524517494, -2.5351365285290477, 2.1198254120589826, -5.316327151246506, 1.9514381972953736, 1.2430256037620493, 0.860282637345946, 4.696959463665405, -3.448600676277184, 1.9367921286948007, 2.3496722487255504, 0.667457710695555, -2.1083560046490564, -1.022267508620894, 2.437288478009722, -1.1465646910396095, 1.2706817566031356, -3.6814377874579916, 3.5403827505493433, -2.555058963566463, 2.5271766104489766, 5.767976781259154, 1.4373419684036208, -2.029128118081242, 0.9930713740987744, -2.5579539608374597, -3.354518491499142, 6.381352740000354, 0.7422260836810609, -0.23209904745334825, 2.5505616275150103, 2.610500363288247, -2.1502973535677747, -1.2218857460406676, -3.565405114028211, 2.531907739048857, -1.7180798521620206, 4.7173873200597995, 0.7892292192742814, -2.76258388271263, -1.197740649360385, 3.653146823527153, -0.1347664621650312, 0.6458861112394583, -1.0829791959480242, -1.0703339207808389, -4.824515075047008, 0.07627913095699489, 2.100643404380273, -3.1315520761685756, -2.411893690513224, -4.157775398388085, 3.3197379538089686, -3.81039802359994, -1.8415737018300427, -2.4407995371066327, -1.0821850972636722, 2.0211851660316924, -3.037897815848126, -5.485266978820272), 
  y = c(-0.5036407751781548, 2.4463228277601874, 0.18715701064699083, 2.6546040184713076, 0.13685838037036957, 0.18446788586440363, 0.12636323140055417, -13.06136324334682, 0.18018672229773408, 10.380355776484256, -3.2468987172723396, 0.3404443966908537, 0.3781078890938982, 9.027280885152884, 0.12344453139217995, 1.2038157775778742, -12.260185304344892, 0.21167992175628952, 0.3553731458226646, 0.253211233480298, -0.17046273277022322, 0.19761116718590102, 0.5289378741408852, 0.295964538031099, 0.4466934535689174, 0.29677053110234364, 0.543693993383739, 0.24640962718993353, 0.32031261344838957, 0.13574947039839308, 0.4363181337842162, 0.2720190348039109, -11.513533065144198, 0.16386974223743944, 3.319030142410866, 0.17320724635226842, -0.22587764039190383, 0.3353006427486837, -0.007444172664956046, 4.017083839065915, -0.19388524118030934, 0.19374438716290066, 0.3388729398314571, 0.13339114046391679, -0.31645047878338084, 0.5565610513906494, -1.4298761604542076, 0.4075419875558799, 1.6917266710525478, 0.25788424177914043, 0.2679271931879743, 0.46087438178569134, 1.5700929005725741, 1.1004844085238734, 0.2588898426506878, -0.059512996651281444, 0.35931307463578244, 0.1853417868928748, 0.22892326805474494, 0.22144793420744585, -13.164372627236595, -13.471564333988866, 0.46541812826524187, 0.5139128343249849, 0.12129701739120038, -0.22793972898268478, -0.1323419840762637, 1.6918970721056332, 0.07153121956863469, 0.08237235954344929, 0.2048073030008115, 0.37256000644414927, 0.47129372229164945, 0.2696198802243546, 1.779945507873318, 0.4574062180341005, 8.129233371475843, -4.355842167032682, -10.896357674522072, 0.24258549132613522, -0.46151677413320036, 0.449599407107622, 0.32969215125373574, -2.996956217043363, 0.18700317490127838, 0.12821761398840362, 10.35753847980718, 0.23149033943659578, 0.14529509312669908, 0.23497988966854877, 0.2638086029505616, -12.907873365417956, 0.013361849072239593, -9.959553377052595, 0.3672471600229916, 0.02316237164868925, 0.1602992367697023, 1.4827991295069436, -0.014988454617748118, 9.293506488774074, 0.4400917573726004, 0.4977285758407141, 0.2352920010278494, -0.2255311183649086, 0.1423589435147469, 0.2696386028632774, 0.6828027685090544, 0.11745058154201249, 10.621213237273883, 0.14021913567462171, 0.2471731194076054, -0.07484158907367809, 1.409703870255661, 5.322855163056965, 0.6847067385303899, 0.34003624421375034), 
  z = c(-1.5364771732510196, -0.13605003893439604, -0.23453059282153224, 2.111364038746783, -1.0033331884349368, -3.0687344506844854, -0.6949014328578764, 8.469168899850528, -0.7189667360939267, 12.022188370999876, 1.6413471743302754, -0.18275398359959402, -1.824276786179434, 10.402743182584068, -0.20681155188056025, 0.15757348450413095, 8.966692501296317, 0.30190135763007325, -0.20045057285112777, -0.9011157336290075, -0.4673239719776081, 0.4219325039547515, -0.02414600735761178, -1.6028916095589385, -0.040674783921849644, -0.8868482033525819, -3.2222173246929713, -0.007975804508859456, -0.10549141710480474, -1.1985889123670388, -5.189154596812357, 0.14688931712962966, 7.049884234709303, -0.4241784956041311, 0.8815875524792329, -0.30196987819646454, -2.333111837214325, -1.4266009190531386, -1.8804756167901173, 2.18340744270792, -0.6445904518097774, -1.3430613643865046, -0.837443082260231, 0.0886671919669719, -1.2853774543393244, -4.313274968557551, -1.1489951345048597, -0.28930095778824544, -0.18684875446247104, -0.6578972914203665, -0.49303573656287253, -0.824969512260651, -2.4222385028965756, -1.7884204485685025, -1.587325424889677, -2.2010085831885324, -2.6769642912456346, -0.5645517153083277, -2.7190880845359615, 0.352674595953809, 8.73329239169, 9.144724143601024, -1.89332613128797, -5.098603473551251, -0.16254657282860968, -2.7977542420970853, -2.42597691896667, 0.6525630486130903, -0.8116222772320824, -1.3803406643115093, -2.938419661908898, -1.434698643279388, -2.861406920389444, -0.06687953717377504, -1.8217439744629889, -0.7369960656181098, 8.564892016737316, 4.644833813438205, 6.9918137467340005, -0.7170819751628117, -2.089393738338932, -0.13065333232575033, -0.29879411381964693, -2.9654532844375914, -1.9050057684078259, -2.2551931586903295, 12.177032943635593, -2.8711700044287682, -0.3473305773680063, -1.4694976067290553, -0.08766347592196759, 8.28681497571303, -0.47263066102776513, 4.42631980936791, -2.4733051288074615, -0.21702462827600025, -1.1758281874026766, -1.906687240503299, -1.4962324201014652, 10.99074867173792, -0.9414482785621717, -1.200542690660604, 0.3872130363352208, -1.3941237924570162, -2.7421115096098845, -0.07507341836933086, 0.5383751966939083, 0.2002389114182608, 12.097805389395608, 0.19454815605656975, -1.1487544140784798, -0.4402223830380939, 0.23940763414156968, 4.326582779513842, 0.19100665943653336, 0.28646056017631466)
)
data <- list(trace1, trace2, trace3)
layout <- list(
  scene = list(
    xaxis = list(
      title = "PC1", 
      showline = TRUE 
    ), 
    yaxis = list(
      title = "PC2", 
      showline = FALSE
    ), 
    zaxis = list(
      title = "PC3", 
      showline = FALSE
    )
  ), 
  title = "PCA (3D)"
)

#p <- plot_ly(d, x = carat, y = price, text = paste("Clarity: ", clarity),
#			              mode = "markers", color = carat, size = carat)




file <- "Genes_TCC_normalized.txt"

matrix <- read.table(file,header=T,sep="\t",row.names=1)
matrix <- na.omit(matrix)
samplename <- colnames(matrix)
genename <- rownames(matrix)

normalized_col <- grep( "normalized" , colnames(matrix))
normalized_col
matrix <- matrix[,normalized_col]
rownames(matrix) <- genename
matrix<- t(matrix)
dim(matrix)

ColorFile <- "./groupInfo.color.txt"
ColorData <- read.table(ColorFile,row.names=1,header=TRUE,sep="\t")
label = as.character(ColorData$Color)
colorlabel = as.character(ColorData$Color)
group = as.character(ColorData$group)

name = rownames(ColorData)

order_check <- identical(name,rownames(ColorData))
order_check
if(!order_check) stop("order is different between data and color matrix")

#ordered_mat <- matrix[order(apply(matrix,1,var),decreasing=TRUE),]


pca <- prcomp(matrix)

summary(pca)
importance <- summary(pca)$importance
pc1<-100*importance[2,1]
pc2<-100*importance[2,2]
pc3<-100*importance[2,3]

#plot(pca$x[,1],pca$x[,2],xlab="PC1",ylab="PC2",col=label,pch=19,xlim=c(xmin,xmax))
#text(pca$x[,1],pca$x[,2],name,col=label,cex=0.4,adj=c(1,2))
#mtext(paste("PC1=",pc1,"% ","PC2=",pc2,"% ","PC3=",pc3,"% ",sep=""),cex=0.5,line=0.5,col=2,adj=0)

getPalette = colorRampPalette(unique(colorlabel))
df <- data.frame(x=pca$x[,1],y=pca$x[,2],z=pca$x[,3])
p<-plot_ly(df, x=df$x,y=df$y,z=df$z,  text = name, type="scatter3d",mode = "markers", color = group, colors = getPalette(length(unique(colorlabel))))
		    #mode = "markers", color = label, size = carat)


#p <- plot_ly()
#p <- add_trace(p, mode="markers", name=name, type="scatter3d", x=pca$x[,1], y=pca$y[,1], z=pca$z[,1])
#p <- add_trace(p, mode=trace1$mode, name=trace1$name, type=trace1$type, x=trace1$x, y=trace1$y, z=trace1$z)
#p <- add_trace(p, mode=trace2$mode, name=trace2$name, type=trace2$type, x=trace2$x, y=trace2$y, z=trace2$z)
#p <- add_trace(p, mode=trace3$mode, name=trace3$name, type=trace3$type, x=trace3$x, y=trace3$y, z=trace3$z)
p <- layout(p, scene=layout$scene, title=layout$title)
htmlwidgets::saveWidget(as_widget(p), "index.html")



